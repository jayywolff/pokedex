dist: focal
language: ruby
rvm:
 - 2.6.3
services:
  - postgresql
addons:
  postgresql: "13"
  apt:
    packages:
      - postgresql-13
      - postgresql-client-13
env:
  matrix:
    - TEST_SUITE=rspec
  global:
  - PGPORT=5433
  - PGUSER=travis
before_script:
  - cp config/database.yml.travis config/database.yml
  - sudo systemctl start postgresql.service
  - psql -c 'create database travis_ci_test;' -U postgres
  - export TZ=America/New_York
script:
  - bundle exec rake db:test:prepare
  - bundle exec $TEST_SUITE
